# PrognozAi.ru - Интеллектуальная Платформа Спортивной Аналитики (MVP)

## О Проекте

PrognozAi.ru — это интеллектуальная веб-платформа, предназначенная для всестороннего предматчевого анализа спортивных событий (футбол, теннис), ИИ-прогнозирования исходов, управления стратегиями ставок, автоматической генерации SEO-оптимизированного контента и формирования активного пользовательского сообщества.

**Ключевое Уникальное Торговое Предложение (УТП):**
*   **Персонализированный AI-ассистент "Палыч"**: Дает объяснимые прогнозы и советы.
*   **Интеллектуальная генерация контента**: Автоматическое создание аналитических обзоров и SEO-статей.
*   **Единая платформа**: Совмещение экспертной базы данных, ручных и AI-стратегий, а также пользовательских прогнозов.

**Целевая аудитория:**
*   Начинающие и опытные бетторы.
*   Спортивные аналитики и журналисты.
*   Болельщики, интересующиеся прогнозами.
*   Владельцы тематических ресурсов.

## Технологический Стек (MVP)

*   **Бэкенд:** PHP 8.2+ (без тяжелых фреймворков, процедурный/ООП подход)
*   **База данных:** MariaDB 10.5+
*   **Фронтенд:** HTML5, CSS3, JavaScript (минимальное использование, без SPA-фреймворков, фокус на серверном рендеринге)
*   **ETL/AI (будущие модули):** Python 3.10+
*   **Веб-сервер:** Apache или Nginx (с PHP-FPM)

## Структура Проекта

Проект имеет следующую основную структуру директорий:
Use code with caution.
Markdown
prognozai/
│
├── backend/
│ ├── config/ # Конфигурационные файлы (db_config.php, odds_market_mapper_config.php)
│ ├── core/ # Ядро системы (DatabaseConnection.php, вспомогательные классы Utils)
│ ├── DataIngestion/ # Модули для сбора и обработки данных (Parsers)
│ ├── DataManagement/ # Модули для управления данными (Repositories, Entities)
│ ├── public/ # Публичная директория, точка входа (add_event_batch.php, index.php - будущий)
│ └── (другие модули: Admin, AI, Community, Seo, Services - по мере развития)
│
├── database/
│ └── schema/
│ └── prognozai_FINAL_SCHEMA.sql # Актуальный DDL для создания БД
│
├── frontend/ # HTML-шаблоны и статические ассеты для пользовательской части
│ ├── templates/ # PHP-шаблоны для страниц (header.php, footer.php, match_list.php, match_view.php и т.д.)
│ └── static/ # CSS, JS, изображения
│
├── docs/ # Документация проекта (включая это README)
│
└── (другие директории: etl, tests - по мере развития)
## Пользовательская Веб-Часть (Фронтенд MVP)

Фронтенд для MVP будет реализован с использованием серверного рендеринга PHP и HTML-шаблонов. Основной упор делается на предоставление информации и базовое взаимодействие.

### Ключевые Страницы и Функционал для Пользователей (MVP):

1.  **Главная Страница (`index.php` или `/`)**
    *   **Назначение:** Приветственная страница, краткое описание УТП проекта.
    *   **Контент:**
        *   Привлекающий заголовок и подзаголовок.
        *   Список ближайших/актуальных матчей (например, 5-10 матчей) с основной информацией (команды, лига, дата/время).
        *   Ссылки на ключевые разделы (например, "Все матчи", "Прогнозы AI" - если будут отдельные страницы).
    *   **Техническая реализация:** PHP-скрипт, который получает данные из `MatchesRepository` и рендерит HTML-шаблон.

2.  **Список Матчей (например, `matches.php` или `/matches`)**
    *   **Назначение:** Отображение полного списка матчей с возможностью базовой фильтрации.
    *   **Контент:**
        *   Таблица или карточки матчей. Для каждого матча:
            *   Названия команд (с логотипами, если есть).
            *   Название лиги и страна.
            *   Дата и время начала (в локальном времени пользователя или с указанием часового пояса).
            *   Статус матча (предстоящий, идет, завершен).
            *   Ссылка на страницу детального просмотра матча.
        *   **Фильтрация (MVP - базовая):** По виду спорта (футбол/теннис), по дате (сегодня, завтра, прошедшие).
    *   **Техническая реализация:** PHP-скрипт с использованием `MatchesRepository`, `LeaguesRepository`, `ClubsRepository`. Пагинация для больших списков.

3.  **Страница Матча (например, `match_view.php?id=<match_id>` или `/match/<match_id>`)**
    *   **Назначение:** Отображение всей доступной информации и аналитики по конкретному матчу.
    *   **Контент:**
        *   **Основная информация:** Команды (с лого), лига, дата/время, стадион (если есть).
        *   **Текущий счет** (если матч идет или завершен).
        *   **Коэффициенты:** Блок с коэффициентами от основного источника (Фонбет) на ключевые рынки (1X2, тотал, фора, двойной шанс). Данные из `OddsRepository` и `BettingMarketsRepository`.
        *   **AI-Прогноз "Палыча"**:
            *   Четко выделенный блок.
            *   Для MVP это может быть текстовое описание прогноза (например, "Палыч прогнозирует: Победа Хозяев (65%), Тотал Больше 2.5 (55%)") или простой числовой вывод.
            *   Данные из `ai_predictions` или `ext_ai_explanations`.
        *   **(MVP-опционально, если успеем)** Возможность для авторизованного пользователя добавить матч в "Избранное".
    *   **Техническая реализация:** PHP-скрипт, получающий `match_id`, загружающий данные через соответствующие репозитории.

4.  **Регистрация Пользователя (например, `register.php` или `/register`)**
    *   **Назначение:** Форма для создания нового аккаунта.
    *   **Поля:** Логин (username), Email, Пароль, Подтверждение пароля.
    *   **Логика:** Валидация данных, проверка уникальности username/email, хеширование пароля, запись в таблицу `users` через `UsersRepository`.
    *   **Безопасность:** Защита от CSRF (рекомендуется).

5.  **Вход Пользователя (например, `login.php` или `/login`)**
    *   **Назначение:** Форма для аутентификации пользователя.
    *   **Поля:** Логин или Email, Пароль.
    *   **Логика:** Поиск пользователя, проверка хеша пароля, создание сессии.
    *   **Безопасность:** Защита от CSRF.

6.  **Профиль Пользователя (базовый, например, `profile.php` или `/profile`)**
    *   **Назначение:** Доступен только авторизованным пользователям.
    *   **Контент:** Отображение имени пользователя, email. Ссылка на выход.
    *   **(MVP-опционально)** Список "избранных" матчей.

7.  **Статические Страницы (например, `about.php`, `faq.php`, `contacts.php`)**
    *   **Назначение:** Информационные страницы.
    *   **Контент:** Текстовая информация, возможно, на основе предоставленных HTML-шаблонов (`community.html`, `faq.html`).

### Общие Элементы UI (для всех страниц):

*   **Шапка (Header):**
    *   Логотип (или название сайта).
    *   Главное меню навигации (Главная, Матчи, Вход/Регистрация или Профиль/Выход).
    *   Переключатель языка (RU/EN).
*   **Подвал (Footer):**
    *   Копирайт, ссылки на "О нас", "Контакты", "Пользовательское соглашение".
*   **Стили:** Простые, чистые CSS-стили, обеспечивающие адаптивность хотя бы для десктопных и планшетных разрешений. Мобильная версия – хороший плюс, если будет время.

### Технологии Фронтенда (MVP):

*   **HTML5** для структуры.
*   **CSS3** для стилизации. Использование простого CSS, возможно, с базовыми принципами БЭМ или другой методологии для организации стилей.
*   **JavaScript (Vanilla JS):** Только при необходимости для минимальной интерактивности (например, валидация форм на клиенте, открытие/закрытие элементов). Избегать сложных JS-фреймворков и библиотек на этапе MVP.
*   **Серверный Рендеринг:** Все страницы генерируются на стороне сервера с помощью PHP.

## Установка и Запуск (MVP)

1.  **Требования к серверу:**
    *   Веб-сервер (Apache 2.4+ или Nginx).
    *   PHP 8.2+ (с расширениями: `pdo_mysql`, `mbstring`, `json`, `intl` - для локализации дат и чисел).
    *   MariaDB 10.5+ (или совместимый MySQL).
    *   Composer (для управления зависимостями PHP, если будет использоваться).

2.  **Установка Базы Данных:**
    *   Создайте базу данных с именем `prognozai_db` (или именем, указанным в `backend/config/db_config.php`) с кодировкой `utf8mb4` и сопоставлением `utf8mb4_unicode_ci`.
    *   Импортируйте схему из файла `database/schema/prognozai_FINAL_SCHEMA.sql`.
    *   Заполните ключевые справочники начальными данными (Seed-данные, см. раздел ниже).

3.  **Настройка Проекта:**
    *   Клонируйте репозиторий: `git clone https://github.com/Blade2403/prognozai.git`
    *   Перейдите в директорию проекта: `cd prognozai`
    *   **Конфигурация БД:** Скопируйте `backend/config/db_config.php.example` (если есть) в `backend/config/db_config.php` и укажите ваши реальные учетные данные для подключения к MariaDB. Если файла `.example` нет, создайте `db_config.php` на основе предоставленного ранее кода.
    *   **(Опционально) Composer:** Если в проекте будет `composer.json` для автозагрузки или зависимостей, выполните `composer install` в директории `backend/`.

4.  **Настройка Веб-сервера:**
    *   Укажите `DocumentRoot` (для Apache) или `root` (для Nginx) на директорию `prognozai/backend/public/`.
    *   Убедитесь, что веб-сервер настроен на корректную обработку `.php` файлов через PHP-FPM (рекомендуется) или `mod_php`.
    *   Пример конфигурации для Nginx (упрощенно):
        ```nginx
        server {
            listen 80;
            server_name prognozai.local; # Замените на ваш домен
            root /path/to/your/prognozai/backend/public;
            index index.php;

            location / {
                try_files $uri $uri/ /index.php?$query_string;
            }

            location ~ \.php$ {
                include snippets/fastcgi-php.conf;
                fastcgi_pass unix:/var/run/php/php8.2-fpm.sock; # Путь к вашему PHP-FPM сокету
                fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
                include fastcgi_params;
            }
        }
        ```
    *   Перезапустите веб-сервер.

5.  **Права Доступа:**
    *   Убедитесь, что пользователь веб-сервера (например, `www-data`) имеет права на чтение файлов проекта и на запись в директории, где это необходимо (например, для логов, если они пишутся PHP, или для кеша).

## Заполнение Начальными Данными (Seed Data)

Для корректной работы и тестирования MVP необходимо предзаполнить следующие справочники:
*   `sports`: Футбол, Теннис (уже есть в DDL).
*   `countries`: Основные страны, включая "International" (`iso_alpha2='XX'`).
*   `data_sources`: 'Fonbet_CopyPaste_Parser', 'PrognozAi_Manual_Admin', 'PrognozAi_System_Default' (уже есть в DDL). Добавьте источники для AI, если планируется их использование в ближайшее время.
*   `user_roles`: admin, viewer, expert и т.д. (уже есть в DDL).
*   `betting_markets`: ВСЕ рынки, определенные в `backend/config/odds_market_mapper_config.php` для футбола и тенниса.
*   `stat_types`: Основные типы статистики для футбола и тенниса.
*   `event_types`, `bonus_types`, `achievement_types`: Базовый набор (частично есть в DDL).
*   `system_settings`: `default_language`, `default_currency` и т.д.
*   (Опционально) Несколько тестовых записей в `users`, `leagues`, `clubs`, `players` для демонстрации.

Скрипты для seed-данных могут находиться в директории `database/seeds/`.

## Ключевые PHP Компоненты (для разработчика MVP)

*   **`backend/public/add_event_batch.php`**: Основной скрипт для импорта данных линии Фонбет. Точка входа для администратора.
*   **`backend/config/db_config.php`**: Конфигурация подключения к БД.
*   **`backend/config/odds_market_mapper_config.php`**: Маппинг ключей коэффициентов парсера на структуру БД.
*   **`backend/core/DatabaseConnection.php`**: Класс для управления PDO-соединением.
*   **`backend/core/Utils/DateTimeHelper.php`**: Вспомогательный класс для работы с датами.
*   **`backend/core/Utils/TextPreprocessor.php`**: Класс для предварительной очистки текста.
*   **`backend/DataIngestion/Parsers/FonbetLeagueTextParser.php`**: Класс-парсер для текстовой линии Фонбет.
*   **Репозитории в `backend/DataManagement/Repositories/`**: Классы для взаимодействия с таблицами БД (`SportsRepository`, `CountriesRepository`, `MatchesRepository`, `OddsRepository` и т.д.).

## Дальнейшие Шаги (После MVP)

*   Разработка полноценной админ-панели.
*   Интеграция с реальными AI-моделями для прогнозирования.
*   Расширение на другие виды спорта.
*   Развитие модуля стратегий ставок.
*   Улучшение и расширение функционала сообщества (комментарии, рейтинги, конкурсы).
*   Внедрение системы монетизации.
*   Автоматизация ETL-процессов для сбора данных из различных источников.

---
Этот `README.md` должен дать хорошее общее представление о проекте, его текущем состоянии для MVP и планах. Вы можете его дополнять и изменять по ходу разработки.
